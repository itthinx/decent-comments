(()=>{"use strict";var e={609:e=>{e.exports=window.React},723:e=>{e.exports=window.wp.i18n},727:(e,t,n)=>{n.d(t,{PU:()=>s,p4:()=>l});var o=n(609);const a=window.wp.apiFetch;var c=n.n(a),r=n(723);async function l(e,t){const n=function(e){const t={number:e.number||5,offset:e.offset||0,order:e.order||"asc",orderby:e.orderby||"comment_author_email",...e.post_id&&{post_id:e.post_id},...e.post__in&&{post__in:e.post__in},...e.post__not_in&&{post__not_in:e.post__not_in},...e.post_type&&{post_type:e.post_type},...e.taxonomy&&{taxonomy:e.taxonomy},...e.terms&&{terms:e.terms},...e.term_ids&&{term_ids:e.term_ids},...e.exclude_post_author&&{exclude_post_author:e.exclude_post_author},...e.pingback&&{pingback:e.pingback},...e.trackback&&{trackback:e.trackback}};return new URLSearchParams(t)}(e);return await c()({path:`decent-comments/v1/comments?${n.toString()}`,method:"GET",headers:{"X-WP-Nonce":t}})}const s=({comments:e,attributes:t})=>(0,o.createElement)("div",{className:"decent-comments"},t.title?.length>0&&(0,o.createElement)("div",{className:"decent-comments-heading gamma widget-title"},_(t.title)),(0,o.createElement)("ul",{className:"decent-comments list-none"},0===e.length?(0,o.createElement)("li",null,(0,r.__)("No Comments","decent-comments")):e.filter(e=>!t.exclude_post_author||e.author_email!==e.post_author).map(e=>(0,o.createElement)(m,{key:e.id,comment:e,attributes:t})))),m=({comment:e,attributes:t})=>{const n=t.show_author?t.link_authors&&e.author_url?(0,o.createElement)("a",{href:_(e.author_url),className:"comment-author-link"},_(e.author)):_(e.author):null,a=t.show_date?`${new Date(e.date).toLocaleDateString(void 0,{year:"numeric",month:"long",day:"numeric",hour12:!0})} ${(0,r.__)("at","decent-comments")} ${new Date(e.date).toLocaleTimeString()}`:null,c=t.show_avatar&&e.avatar?(0,o.createElement)("img",{src:_(e.avatar),alt:_(e.author||""),width:t.avatar_size||48,height:t.avatar_size||48,className:"rounded-full"}):null,l=t.show_comment?function(e,t){let n=t.show_excerpt?e:"";if(t.strip_tags&&(n=n.replace(/(<([^>]+)>)/gi,"")),t.max_excerpt_words>0){const e=n.split(" ");n=e.slice(0,t.max_excerpt_words).join(" ")+(e.length>t.max_excerpt_words?_(t.ellipsis):"")}return t.max_excerpt_characters>0&&(n=n.substring(0,t.max_excerpt_characters)+(n.length>t.max_excerpt_characters?_(t.ellipsis):"")),_(n)}(e.content,t):"",s=t.show_link&&e.comment_link?(0,o.createElement)("span",null,(0,r.__)("on","decent-comments")," ",(0,o.createElement)("a",{href:_(e.comment_link||"#"),className:"comment-post-title"},_(e.post_title||""))):null;return(0,o.createElement)("li",{key:e.id,className:"comment"},c,(0,o.createElement)("div",{className:"comment-content"},n&&(0,o.createElement)("span",{className:"comment-author"},n," "),a&&(0,o.createElement)("span",{className:"comment-date"},a," "),s," ",l&&(0,o.createElement)("span",{className:"comment-excerpt"},l)))};function _(e){const t=document.createElement("div");return t.textContent=e||"",t.innerHTML}}},t={};function n(o){var a=t[o];if(void 0!==a)return a.exports;var c=t[o]={exports:{}};return e[o](c,c.exports,n),c.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var o=n(609);const a=window.wp.blocks;var c=n(723);const r=window.wp.blockEditor,l=window.wp.components,s=JSON.parse('{"UU":"decent-comments-block/decent-comments"}'),m=window.wp.element;var _=n(727);(0,a.registerBlockType)(s.UU,{apiVersion:3,title:(0,c.__)("Decent Comments","decent-comments"),icon:"admin-comments",category:"widgets",attributes:{title:{type:"string",default:""},number:{type:"number",default:5},offset:{type:"number",default:0},post_id:{type:"string",default:""},post__in:{type:"string",default:""},post__not_in:{type:"string",default:""},post_tag:{type:"string",default:""},exclude_post_author:{type:"boolean",default:!1},show_author:{type:"boolean",default:!0},show_date:{type:"boolean",default:!0},link_authors:{type:"boolean",default:!0},show_avatar:{type:"boolean",default:!0},avatar_size:{type:"number",default:48},show_link:{type:"boolean",default:!0},show_comment:{type:"boolean",default:!0},taxonomy:{type:"string",default:""},terms:{type:"string",default:""},pingback:{type:"boolean",default:!0},trackback:{type:"boolean",default:!0},show_excerpt:{type:"boolean",default:!0},max_excerpt_words:{type:"number",default:20},max_excerpt_characters:{type:"number",default:0},ellipsis:{type:"string",default:""},strip_tags:{type:"boolean",default:!0},order:{type:"string",default:"desc"},orderby:{type:"string",default:"comment_date_gmt"},class:{type:"string",default:""},post_type:{type:"string",default:"post"}},edit:({attributes:e,setAttributes:t})=>{(0,r.useBlockProps)();const[n,a]=(0,m.useState)([]),[s,i]=(0,m.useState)(null);return(0,m.useEffect)(()=>{(async()=>{try{const t={...e};"[current]"!==e.post_id&&"{current}"!==e.post_id||(t.post_id=""),"[current]"!==e.terms&&"{current}"!==e.terms||(t.term_ids="");const n=window.decentCommentsEdit?.nonce||"",o=await(0,_.p4)(t,n);a(o.comments||[]),i(null)}catch(e){i(e),a([])}})()},[e]),(0,o.createElement)(o.Fragment,null,(0,o.createElement)(r.InspectorControls,null,(0,o.createElement)(l.PanelBody,{title:(0,c.__)("Comment Settings","decent-comments")},(0,o.createElement)(l.TextControl,{label:(0,c.__)("Title","decent-comments"),value:e.title,onChange:e=>t({title:e})}),(0,o.createElement)(l.TextControl,{label:(0,c.__)("Number of Comments","decent-comments"),value:e.number,onChange:e=>t({number:parseInt(e)||5}),min:"1",type:"number"}),(0,o.createElement)(l.SelectControl,{label:(0,c.__)("Order by...","decent-comments"),value:e.orderby,options:[{label:(0,c.__)("Author Email","decent-comments"),value:"comment_author_email"},{label:(0,c.__)("Author URL","decent-comments"),value:"comment_author_url"},{label:(0,c.__)("Content","decent-comments"),value:"comment_content"},{label:(0,c.__)("Comment Date","decent-comments"),value:"comment_date_gmt"},{label:(0,c.__)("Karma","decent-comments"),value:"comment_karma"},{label:(0,c.__)("Post","decent-comments"),value:"comment_post_id"}],onChange:e=>t({orderby:e})}),(0,o.createElement)(l.SelectControl,{label:(0,c.__)("Sort order","decent-comments"),value:e.order,options:[{label:(0,c.__)("Descending","decent-comments"),value:"desc"},{label:(0,c.__)("Ascending","decent-comments"),value:"asc"}],onChange:e=>t({order:e})}),(0,o.createElement)(l.TextControl,{label:(0,c.__)("Post ID","decent-comments"),value:e.post_id,onChange:e=>t({post_id:e||""}),help:(0,c.__)("Title, empty, post ID or [current]","decent-comments")}),(0,o.createElement)(l.TextControl,{label:(0,c.__)("Post type","decent-comments"),value:e.post_type,onChange:e=>t({post_type:e}),help:(0,c.__)("Available post types: "+decentCommentsEdit.post_types,"decent-comments")}),(0,o.createElement)(l.ToggleControl,{label:(0,c.__)("Exclude comments from post authors","decent-comments"),checked:e.exclude_post_author,onChange:e=>t({exclude_post_author:e})}),(0,o.createElement)(l.ToggleControl,{label:(0,c.__)("Show comment excerpt","decent-comments"),checked:e.show_excerpt,onChange:e=>t({show_excerpt:e})}),(0,o.createElement)(l.TextControl,{label:(0,c.__)("Number of words in excerpts","decent-comments"),value:e.max_excerpt_words,onChange:e=>t({max_excerpt_words:parseInt(e)||20}),min:"0",type:"number"}),(0,o.createElement)(l.TextControl,{label:(0,c.__)("Number of characters in excerpts","decent-comments"),value:e.max_excerpt_characters,onChange:e=>t({max_excerpt_characters:parseInt(e)||0}),min:"0",type:"number"}),(0,o.createElement)(l.TextControl,{label:(0,c.__)("Ellipsis"),value:e.ellipsis,onChange:e=>t({ellipsis:e}),help:(0,c.__)("The ellipsis is shown after the excerpt when there is more content.","decent-comments")}),(0,o.createElement)(l.ToggleControl,{label:(0,c.__)("Show author","decent-comments"),checked:e.show_author,onChange:e=>t({show_author:e})}),(0,o.createElement)(l.ToggleControl,{label:(0,c.__)("Show date","decent-comments"),checked:e.show_date,onChange:e=>t({show_date:e})}),(0,o.createElement)(l.ToggleControl,{label:(0,c.__)("Link authors","decent-comments"),checked:e.link_authors,onChange:e=>t({link_authors:e}),help:(0,c.__)("Whether to link comment authors to their website.","decent-comments")}),(0,o.createElement)(l.ToggleControl,{label:(0,c.__)("Show avatar","decent-comments"),checked:e.show_avatar,onChange:e=>t({show_avatar:e})}),(0,o.createElement)(l.TextControl,{label:(0,c.__)("Avatar size","decent-comments"),value:e.avatar_size,onChange:e=>t({avatar_size:parseInt(e)||48}),min:"0",type:"number"}),(0,o.createElement)(l.ToggleControl,{label:(0,c.__)("Show link to post","decent-comments"),checked:e.show_link,onChange:e=>t({show_link:e})}),(0,o.createElement)(l.ToggleControl,{label:(0,c.__)("Show the comment","decent-comments"),checked:e.show_comment,onChange:e=>t({show_comment:e})}),(0,o.createElement)(l.SelectControl,{label:(0,c.__)("Taxonomy","decent-comments"),value:e.taxonomy,options:[{label:(0,c.__)("All post taxonomies","decent-comments"),value:""},{label:(0,c.__)("category","decent-comments"),value:"category"},{label:(0,c.__)("tag","decent-comments"),value:"post_tag"}],onChange:e=>t({taxonomy:e}),help:(0,c.__)("Select category if you would like to show comments on posts in certain categories. Give the desired categories' slugs in Term. For tags select post_tag and give the tags' slugs in Term.","decent-comments")}),(0,o.createElement)(l.TextControl,{label:(0,c.__)("Term","decent-comments"),value:e.terms,onChange:e=>t({terms:e})}),(0,o.createElement)(l.ToggleControl,{label:(0,c.__)("Pingbacks","decent-comments"),checked:e.pingback,onChange:e=>t({pingback:e})}),(0,o.createElement)(l.ToggleControl,{label:(0,c.__)("Trackbacks","decent-comments"),checked:e.trackback,onChange:e=>t({trackback:e})}))),(0,o.createElement)("div",{...(0,r.useBlockProps)({className:"wp-block-itthinx-decent-comments","data-attributes":JSON.stringify(e)})},s?(0,o.createElement)("div",{className:"decent-comments-error"},(0,o.createElement)("p",null,(0,c.__)("Error loading comments in editor","decent-comments"),s.message&&`: ${s.message}`)):(0,o.createElement)("div",{className:"wp-block-itthinx-decent-comments"},(0,o.createElement)(_.PU,{comments:n,attributes:e}))))},save:({attributes:e})=>(0,o.createElement)("div",{className:"wp-block-itthinx-decent-comments","data-attributes":JSON.stringify(e)},(0,o.createElement)("p",null,(0,c.__)("Decent Comments Placeholder","decent-comments")))})})();